<!--
  ~ Copyright 2017 Okta, Inc.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
  <html xmlns:th="http://www.thymeleaf.org">
  <head>
      <title>Login</title>
      <!--/*/ <th:block th:include="head :: head"/> /*/-->
  
      <script src="https://global.oktacdn.com/okta-signin-widget/3.9.2/js/okta-sign-in.min.js" type="text/javascript"></script>
      <script src="https://ok1static.oktacdn.com/assets/js/sdk/okta-auth-js/3.9.2/okta-auth-js.min.js" type="text/javascript"></script>
      <link href="/css/okta.css" rel="stylesheet" type="text/css"/>
      <link href="https://global.oktacdn.com/okta-signin-widget/3.9.2/css/okta-sign-in.min.css" type="text/css" rel="stylesheet"/>
      <!--<link href="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/2.13.0/css/okta-theme.css" type="text/css" rel="stylesheet"/>-->
  
  </head>
  <div style="background-image: url('https://images.pexels.com/photos/1103970/pexels-photo-1103970.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940');">
  <body class="login">

    <form>
      <input type="button" onclick="window.location.href='https://dev-497881.oktapreview.com/oauth2/default/v1/authorize?client_id=0oatq7eri9t3BP0610h7&response_type=code&response_mode=query&scope=openid&redirect_uri=https://loancare.com&state=test1234&nonce=test1234&code_challenge_method=S256&code_challenge=qjrzSW9gMiUgpUvqgEPE4_-8swvyCtfOVvg55o5S_es';" value="PKCE Flow" />
      <input type="button" onclick="window.location.href='https://dev-497881.oktapreview.com/oauth2/default/v1/authorize?client_id=0oat0pm28wTzcJmey0h7&response_type=id_token&response_mode=fragment&scope=openid&redirect_uri=https%3A%2F%2Fwww.googlefdfdsfds.com&state=test1234&nonce=test1234';" value="Implicit Flow" />
   
    </form>
   
   
    <div id="sign-in-widget"></div>
  
  <script th:inline="javascript">
  /*<![CDATA[*/
/*
  var urlParams = new URLSearchParams(window.location.search);
  var recToken = console.log(urlParams.toString()); // "?post=1234&action=edit"
 
*/

  var config = {};
  
  config.baseUrl = /*[[${oktaBaseUrl}]]*/ 'https://dev-497881.oktapreview.com';
  config.clientId = /*[[${oktaClientId}]]*/ '0oat0pm28wTzcJmey0h7';
  config.redirectUri = /*[[${redirectUri}]]*/ '/authorization-code/callback';
  config.logo = 'https://ok7static.oktacdn.com/fs/bco/1/fs016n8bifhZ4atv8357';
//  config.recoveryToken = recToken;
  config.features =  {
              idpDiscovery: true,
              rememberMe: false,
              selfServiceUnlock: true,
              router: true
            };
            
  config.idpDiscovery = {                  
                      requestContext: 'http://localhost:8080/oauth2/authorization/okta'
                   };


                   config.idps = [
  // {type: 'FACEBOOK', id: '782745745886876' },
   {type: 'FACEBOOK', id: '0oat10k6z2VpJxRcR0h7' },
   {type: 'GOOGLE', id: '0oat0qx06cHHEBX6k0h7' }
]

  
  config.authParams = {
    issuer: /*[[${issuerUri}]]*/ '{issuerUri}',
    responseType: 'code',
    state: /*[[${state}]]*/ '{state}' || false,
    scopes: /*[[${scopes}]]*/ '[scopes]',
    display: 'page'
  };

  var oktaSignIn = new OktaSignIn(config);
 
  /*
  oktaSignIn.authClient.session.get().then(function(res) {
      if (res.status === "ACTIVE") {		
         console.log("user has a session")
          oktaSignIn.authClient.token
                  .getWithRedirect({
                    state:  '{state}',
                    responseType: ["id_token"],
                    scopes: ["openid", "email", "profile"]
                  })
          }
      else{
          oktaSignIn.renderEl(
            { el: '#sign-in-widget' },

            function (res) {
                          if (res.status === "IDP_DISCOVERY") {				
                              res.idpDiscovery.redirectToIdp();                
                          }
                        }
          );
      
      }

    
  });

  */

  oktaSignIn.renderEl(
            { el: '#sign-in-widget' },

            function (res) {
                          if (res.status === "IDP_DISCOVERY") {				
                              res.idpDiscovery.redirectToIdp();                
                          }
                        }
          );
  
  /*]]>*/
  </script>
  
  </body>
</div>
  </html>